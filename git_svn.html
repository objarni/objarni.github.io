<html>

<h1>How I use git inside svn repositories</h1>

<i>The purpose of using git at all inside of a svn repository, is to enable "local branches", which just is
the way I like to work with source code (thinking of a specific bug fix, feature add and so on at a time,
while still enabling fetching changes from upstream anytime I want to, e.g. daily). So the git repository
is never pushed anywhere - it just lives locally, inside of the checked out svn repository folder, like so:</i>

<pre>
C:\prj\project\                # projects root folder
C:\prj\project\subfolder       # some subproject with source code etc.
C:\prj\project\.svn            # this goes in the root and all subdirs
C:\prj\project\subfolder\.svn  #  ...
C:\prj\project\.git            # lives parallell to .svn; make sure you svn ignore it!
C:\prj\project\.gitignore      # Make sure you ignore .svn, and svn ignore this one too
</pre>

<h3>What does git branch master mean?</h3>
Conceptually, you keep the master branch of your git repository in sync with svn, and then you rebase
your feature branches on master as soon as you svn up.

<h3>.gitignore</h3>
<ul>
<li>ignore old binary folders and similar (speed up git dev flow)</li>
<li>ignore svnup bash script</li>
<li>add .gitignore to svn global ignore pattern</li>
</ul>

<h3>Working on local branches</h3>
This is basically as any git workflow: create a branch, check it out, make some changes and commit continually.

<h3>Fetching changes from svn repo</h3>
This is the toughest part of the workflow as it involved merging changes (merges are always a pain!).

To make it a little less mundane, I've written a small bash script that automates the robotic parts of it,
see end of this page:

<pre>   $ ./svnup mybranch</pre>

If you get merge conflicts during rebase, use any text editor to fix the conclicts, then <b>git add</b> the file,
and <b>git rebase --continue</b>.



<h3>Committing changes to svn repo</h3>
<li>checkout master</li>
<li>merge branch</li>
<li>svn commit</li>

<h3>The svnup bash script</h3>
A helper script that simplifies fetching and merging changes from the svn repository.

<pre>
# svnup git+svn utility script
if [[ $# -eq 0 ]] ; then
    echo 'Usage: svnup <branchname>'
    echo 'Helper script for git+svn. Will update the master branch with latest'
    echo 'changes from svn server, autocommit that to master, jump back to'
    echo '<branchname> and rebase on master. Stops immediately on any fail.'
    exit 1
fi

if [[ $1 == "master" ]]; then
        echo 'Cannot svnup on master branch, only other branches.'
        exit 1
fi

set -e
git checkout $1
git checkout master
svn up
git add .
git commit -m 'autocommit from svnup: changes from svn server' || true
git checkout $1
git rebase master
</pre>


</html>
